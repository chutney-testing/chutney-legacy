<div class="mat-elevation-z8">
  <chutney-page-header
    [title]="'Variables'"
    [breadcrumbs]="breadcrumbs"
    [showBackIcon]="false">
    <chutney-page-header-action>
      <button
        mat-fab
        class="mat-accent"
        aria-label="Save group"
        (click)="saveGlobalVariableGroup()"
        [@animate]="{ value: '*', params: { delay: '300ms', scale: '0.2' } }"
      >
        <mat-icon>save</mat-icon>
      </button>

      <button
        mat-fab
        class="mat-accent"
        aria-label="Add group"
        disabled="{{ addMode || renameMode }}"
        (click)="addGlobalVariableGroup()"
        [@animate]="{ value: '*', params: { delay: '300ms', scale: '0.2' } }"
      >
        <mat-icon>add</mat-icon>
      </button>

      <button
          mat-fab
          class="mat-accent"
          aria-label="Delete group"
          disabled="{{ addMode || renameMode }}"
          (click)="deleteGlobalVariableGroup()"
          [@animate]="{ value: '*', params: { delay: '300ms', scale: '0.2' } }"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </chutney-page-header-action>
  </chutney-page-header>

  <mat-tab-group animationDuration="0ms"
                 [selectedIndex]="activeGroupNameIndex"
                 (selectedIndexChange)="activeGroupNameIndex = $event"
                 (selectedTabChange)="onTabChange($event)"
  >
    <mat-tab *ngFor="let groupName of globalVariableGroupsNames$ | async; let i=index;"
             label="{{ groupName }}"
    >
      <ng-template *ngIf="groupName.length == 0" mat-tab-label>
        <mat-form-field appearance="standard">
          <input matInput
                 id="newGroupNameInput"
                 placeholder="new group"
                 required
          />
        </mat-form-field>
      </ng-template>
      <ng-template *ngIf="groupName.length != 0" mat-tab-label>
        <div *ngIf="i != groupNameRenameIndex" (click)="onGroupNameClick(i)">{{ groupName }}</div>
        <mat-form-field *ngIf="i == groupNameRenameIndex" appearance="standard">
          <input matInput
                 id="renameGroupNameInput"
                 value="{{groupName}}"
                 required
          />
        </mat-form-field>
      </ng-template>
    </mat-tab>
  </mat-tab-group>

  <div class="my-code-editor">
    <td-code-editor #monaco
      fxFlex="grow"
      editorStyle="border:0;"
      language="json"
      [editorOptions]="{ fontSize: 12, automaticLayout: true }"
      [theme]="options.theme === 'light' ? 'vs' : 'vs-dark'"
      [value]="''"
      (editorInitialized)="editorInitialized($event)"
      (editorConfigurationChanged)="monacoEditorConfigChanged(monaco.theme)"
    ></td-code-editor>
  </div>
</div>
